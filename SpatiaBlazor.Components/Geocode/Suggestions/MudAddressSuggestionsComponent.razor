@inherits MudAutocomplete<IGeocodeResultsViewModel>
@implements ISuggestionsView
@implements IDisposable
@inject ISuggestionsPresenter Presenter

@{
    base.BuildRenderTree(__builder);
}

@code {

    public MudAddressSuggestionsComponent()
    {
        DebounceInterval = 600;
        SearchFunc = async args => await Presenter.AutocompleteSuggestions(args, _cts.Token);
        ToStringFunc = model => model?.Label;
        MaxItems = null;
        ShowProgressIndicator = true;
    }
    
    private readonly CancellationTokenSource _cts = new ();

    protected override async Task OnInitializedAsync()
    {
        await Presenter.InitializeAsync(this);
    }

    public void TriggerRender()
    {
        StateHasChanged();
    }

    public void StartLoading()
    {
        //todo alternative loading
    }

    public void StopLoading()
    {
        //todo alternative loading
    }
    
    public void Dispose()
    {
        _cts.Cancel();
        _cts.Dispose();
    }
}